<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>General MCMC diagnostics — MCMC-diagnostics • bayesplot</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="General MCMC diagnostics — MCMC-diagnostics" />
<meta property="og:description" content="Plots of Rhat statistics, ratios of effective sample size to total sample
size, and autocorrelation of MCMC draws. See the Plot Descriptions
section, below, for details. For models fit using the No-U-Turn-Sampler, see
also MCMC-nuts for additional MCMC diagnostic plots." />
<meta property="og:image" content="https://mc-stan.org/bayesplot/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bayesplot</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://mc-stan.org/rstan">rstan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/cmdstanr">cmdstanr</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstanarm">rstanarm</a>
    </li>
    <li>
      <a href="https://mc-stan.org/shinystan">shinystan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/loo">loo</a>
    </li>
    <li>
      <a href="https://mc-stan.org/projpred">projpred</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstantools">rstantools</a>
    </li>
    <li>
      <a href="https://mc-stan.org/posterior">posterior</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://mc-stan.org">Stan</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/mcmc_stan">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stan-dev/bayesplot">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://discourse.mc-stan.org/">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>General MCMC diagnostics</h1>
    <small class="dont-index">Source: <a href='https://github.com/stan-dev/bayesplot/blob/master/R/mcmc-diagnostics.R'><code>R/mcmc-diagnostics.R</code></a></small>
    <div class="hidden name"><code>MCMC-diagnostics.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Plots of Rhat statistics, ratios of effective sample size to total sample
size, and autocorrelation of MCMC draws. See the <strong>Plot Descriptions</strong>
section, below, for details. For models fit using the No-U-Turn-Sampler, see
also <a href='MCMC-nuts.html'>MCMC-nuts</a> for additional MCMC diagnostic plots.</p>
    </div>

    <pre class="usage"><span class='fu'>mcmc_rhat</span><span class='op'>(</span><span class='va'>rhat</span>, <span class='va'>...</span>, size <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>

<span class='fu'>mcmc_rhat_hist</span><span class='op'>(</span><span class='va'>rhat</span>, <span class='va'>...</span>, binwidth <span class='op'>=</span> <span class='cn'>NULL</span>, breaks <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>

<span class='fu'>mcmc_rhat_data</span><span class='op'>(</span><span class='va'>rhat</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>mcmc_neff</span><span class='op'>(</span><span class='va'>ratio</span>, <span class='va'>...</span>, size <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>

<span class='fu'>mcmc_neff_hist</span><span class='op'>(</span><span class='va'>ratio</span>, <span class='va'>...</span>, binwidth <span class='op'>=</span> <span class='cn'>NULL</span>, breaks <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>

<span class='fu'>mcmc_neff_data</span><span class='op'>(</span><span class='va'>ratio</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>mcmc_acf</span><span class='op'>(</span>
  <span class='va'>x</span>,
  pars <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>character</a></span><span class='op'>(</span><span class='op'>)</span>,
  regex_pars <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>character</a></span><span class='op'>(</span><span class='op'>)</span>,
  <span class='va'>...</span>,
  facet_args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  lags <span class='op'>=</span> <span class='fl'>20</span>,
  size <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span>

<span class='fu'>mcmc_acf_bar</span><span class='op'>(</span>
  <span class='va'>x</span>,
  pars <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>character</a></span><span class='op'>(</span><span class='op'>)</span>,
  regex_pars <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>character</a></span><span class='op'>(</span><span class='op'>)</span>,
  <span class='va'>...</span>,
  facet_args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  lags <span class='op'>=</span> <span class='fl'>20</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>rhat</th>
      <td><p>A vector of R-hat estimates.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Currently ignored.</p></td>
    </tr>
    <tr>
      <th>size</th>
      <td><p>An optional value to override <code><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>ggplot2::geom_point()</a></code>'s
default size (for <code>mcmc_rhat()</code>, <code>mcmc_neff()</code>) or
<code><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>ggplot2::geom_line()</a></code>'s default size (for <code>mcmc_acf()</code>).</p></td>
    </tr>
    <tr>
      <th>binwidth</th>
      <td><p>Passed to <code><a href='https://ggplot2.tidyverse.org/reference/geom_histogram.html'>ggplot2::geom_histogram()</a></code> to override
the default binwidth.</p></td>
    </tr>
    <tr>
      <th>breaks</th>
      <td><p>Passed to <code><a href='https://ggplot2.tidyverse.org/reference/geom_histogram.html'>ggplot2::geom_histogram()</a></code> as an
alternative to <code>binwidth</code>.</p></td>
    </tr>
    <tr>
      <th>ratio</th>
      <td><p>A vector of <em>ratios</em> of effective sample size estimates to
total sample size. See <code><a href='bayesplot-extractors.html'>neff_ratio()</a></code>.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>An object containing MCMC draws:</p><ul>
<li><p>A 3-D array, matrix, list of matrices, or data frame. The <a href='MCMC-overview.html'>MCMC-overview</a>
page provides details on how to specify each these.</p></li>
<li><p>A <code>draws</code> object from the <span class="pkg">posterior</span> package (e.g.,
<code>draws_array</code>, <code>draws_rvars</code>, etc.).</p></li>
<li><p>An object with an <code><a href='https://rdrr.io/r/base/array.html'>as.array()</a></code> method that returns the same kind of 3-D
array described on the <a href='MCMC-overview.html'>MCMC-overview</a> page.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>pars</th>
      <td><p>An optional character vector of parameter names. If neither
<code>pars</code> nor <code>regex_pars</code> is specified then the default is to use <em>all</em>
parameters. As of version <code>1.7.0</code>, <strong>bayesplot</strong> also supports 'tidy'
parameter selection by specifying <code>pars = vars(...)</code>, where <code>...</code> is
specified the same way as in <a href='https://dplyr.tidyverse.org/reference/select.html'>dplyr::select(...)</a> and
similar functions. Examples of using <code>pars</code> in this way can be found on the
<a href='tidy-params.html'>Tidy parameter selection</a> page.</p></td>
    </tr>
    <tr>
      <th>regex_pars</th>
      <td><p>An optional <a href='https://rdrr.io/r/base/grep.html'>regular expression</a> to use for
parameter selection. Can be specified instead of <code>pars</code> or in addition to
<code>pars</code>. When using <code>pars</code> for tidy parameter selection, the <code>regex_pars</code>
argument is ignored since <a href='https://tidyselect.r-lib.org/reference/language.html'>select helpers</a>
perform a similar function.</p></td>
    </tr>
    <tr>
      <th>facet_args</th>
      <td><p>A named list of arguments (other than <code>facets</code>) passed
to <code><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>ggplot2::facet_wrap()</a></code> or <code><a href='https://ggplot2.tidyverse.org/reference/facet_grid.html'>ggplot2::facet_grid()</a></code>
to control faceting. Note: if <code>scales</code> is not included in <code>facet_args</code>
then <strong>bayesplot</strong> may use <code>scales="free"</code> as the default (depending
on the plot) instead of the <strong>ggplot2</strong> default of <code>scales="fixed"</code>.</p></td>
    </tr>
    <tr>
      <th>lags</th>
      <td><p>The number of lags to show in the autocorrelation plot.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The plotting functions return a ggplot object that can be further
customized using the <strong>ggplot2</strong> package. The functions with suffix
<code>_data()</code> return the data that would have been drawn by the plotting
function.</p>
    <h2 class="hasAnchor" id="plot-descriptions"><a class="anchor" href="#plot-descriptions"></a>Plot Descriptions</h2>

    

<dl>
<dt><code>mcmc_rhat()</code>, <code>mcmc_rhat_hist()</code></dt><dd><p>Rhat values as either points or a histogram. Values are colored using
different shades (lighter is better). The chosen thresholds are somewhat
arbitrary, but can be useful guidelines in practice.
<ul>
<li><p><em>light</em>: below 1.05 (good)</p></li>
<li><p><em>mid</em>: between 1.05 and 1.1 (ok)</p></li>
<li><p><em>dark</em>: above 1.1 (too high)</p></li>
</ul></p></dd>

<dt><code>mcmc_neff()</code>, <code>mcmc_neff_hist()</code></dt><dd><p>Ratios of effective sample size to total sample size as either points or a
histogram. Values are colored using different shades (lighter is better).
The chosen thresholds are somewhat arbitrary, but can be useful guidelines
in practice.
<ul>
<li><p><em>light</em>: between 0.5 and 1 (high)</p></li>
<li><p><em>mid</em>: between 0.1 and 0.5 (good)</p></li>
<li><p><em>dark</em>: below 0.1 (low)</p></li>
</ul></p></dd>

<dt><code>mcmc_acf()</code>, <code>mcmc_acf_bar()</code></dt><dd><p>Grid of autocorrelation plots by chain and parameter. The <code>lags</code> argument
gives the maximum number of lags at which to calculate the autocorrelation
function. <code>mcmc_acf()</code> is a line plot whereas <code>mcmc_acf_bar()</code> is a
barplot.</p></dd>

</dl>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Stan Development Team.
<em>Stan Modeling Language Users Guide and Reference Manual.</em>
<a href='https://mc-stan.org/users/documentation/'>https://mc-stan.org/users/documentation/</a></p>
<p>Gelman, A. and Rubin, D. B. (1992). Inference from iterative
simulation using multiple sequences. <em>Statistical Science</em>. 7(4),
457--472.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'>
<ul>
<li><p>The <a href='https://mc-stan.org/bayesplot/articles/visual-mcmc-diagnostics.html'>Visual MCMC Diagnostics</a>
vignette.</p></li>
<li><p><a href='MCMC-nuts.html'>MCMC-nuts</a> for additional MCMC diagnostic plots for models fit
using the No-U-Turn-Sampler.</p></li>
</ul>

<p>Other MCMC: 
<code><a href='MCMC-combos.html'>MCMC-combos</a></code>,
<code><a href='MCMC-distributions.html'>MCMC-distributions</a></code>,
<code><a href='MCMC-intervals.html'>MCMC-intervals</a></code>,
<code><a href='MCMC-nuts.html'>MCMC-nuts</a></code>,
<code><a href='MCMC-overview.html'>MCMC-overview</a></code>,
<code><a href='MCMC-parcoord.html'>MCMC-parcoord</a></code>,
<code><a href='MCMC-recover.html'>MCMC-recover</a></code>,
<code><a href='MCMC-scatterplots.html'>MCMC-scatterplots</a></code>,
<code><a href='MCMC-traces.html'>MCMC-traces</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># autocorrelation</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='example-data.html'>example_mcmc_draws</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 250   4   4</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/dimnames.html'>dimnames</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $Iteration
#&gt; NULL
#&gt; 
#&gt; $Chain
#&gt; [1] "chain:1" "chain:2" "chain:3" "chain:4"
#&gt; 
#&gt; $Parameter
#&gt; [1] "alpha"   "sigma"   "beta[1]" "beta[2]"
#&gt; </div><div class='input'>
<span class='fu'><a href='bayesplot-colors.html'>color_scheme_set</a></span><span class='op'>(</span><span class='st'>"green"</span><span class='op'>)</span>
<span class='fu'>mcmc_acf</span><span class='op'>(</span><span class='va'>x</span>, pars <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"alpha"</span>, <span class='st'>"beta[1]"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='MCMC-diagnostics-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># \donttest{</span>
<span class='fu'><a href='bayesplot-colors.html'>color_scheme_set</a></span><span class='op'>(</span><span class='st'>"pink"</span><span class='op'>)</span>
<span class='op'>(</span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'>mcmc_acf_bar</span><span class='op'>(</span><span class='va'>x</span>, pars <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"alpha"</span>, <span class='st'>"beta[1]"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='MCMC-diagnostics-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># add horiztonal dashed line at 0.5</span>
<span class='va'>p</span> <span class='op'>+</span> <span class='fu'><a href='bayesplot-helpers.html'>hline_at</a></span><span class='op'>(</span><span class='fl'>0.5</span>, linetype <span class='op'>=</span> <span class='fl'>2</span>, size <span class='op'>=</span> <span class='fl'>0.15</span>, color <span class='op'>=</span> <span class='st'>"gray"</span><span class='op'>)</span>
</div><div class='img'><img src='MCMC-diagnostics-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># }</span>

<span class='co'># fake rhat values to use for demonstration</span>
<span class='va'>rhat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fl'>100</span>, <span class='fl'>1</span>, <span class='fl'>1.15</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>mcmc_rhat_hist</span><span class='op'>(</span><span class='va'>rhat</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></div><div class='img'><img src='MCMC-diagnostics-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>mcmc_rhat</span><span class='op'>(</span><span class='va'>rhat</span><span class='op'>)</span>
</div><div class='img'><img src='MCMC-diagnostics-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># lollipops</span>
<span class='fu'><a href='bayesplot-colors.html'>color_scheme_set</a></span><span class='op'>(</span><span class='st'>"purple"</span><span class='op'>)</span>
<span class='fu'>mcmc_rhat</span><span class='op'>(</span><span class='va'>rhat</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>]</span>, size <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>
</div><div class='img'><img src='MCMC-diagnostics-6.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'><a href='bayesplot-colors.html'>color_scheme_set</a></span><span class='op'>(</span><span class='st'>"blue"</span><span class='op'>)</span>
<span class='fu'>mcmc_rhat</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fl'>1000</span>, <span class='fl'>1</span>, <span class='fl'>1.07</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='MCMC-diagnostics-7.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>mcmc_rhat</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fl'>1000</span>, <span class='fl'>1</span>, <span class='fl'>1.3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='bayesplot-helpers.html'>legend_move</a></span><span class='op'>(</span><span class='st'>"top"</span><span class='op'>)</span> <span class='co'># add legend above plot</span>
</div><div class='img'><img src='MCMC-diagnostics-8.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># fake neff ratio values to use for demonstration</span>
<span class='va'>ratio</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fl'>100</span>, <span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>mcmc_neff_hist</span><span class='op'>(</span><span class='va'>ratio</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></div><div class='img'><img src='MCMC-diagnostics-9.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>mcmc_neff</span><span class='op'>(</span><span class='va'>ratio</span><span class='op'>)</span>
</div><div class='img'><img src='MCMC-diagnostics-10.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># \dontrun{</span>
<span class='co'># Example using rstanarm model (requires rstanarm package)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://mc-stan.org/rstanarm/'>rstanarm</a></span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Loading required package: Rcpp</span></div><div class='output co'>#&gt; <span class='message'>This is rstanarm version 2.21.2</span></div><div class='output co'>#&gt; <span class='message'>- See https://mc-stan.org/rstanarm/articles/priors for changes to default priors!</span></div><div class='output co'>#&gt; <span class='message'>- Default priors may change, so it's safest to specify priors, even if equivalent to the defaults.</span></div><div class='output co'>#&gt; <span class='message'>- For execution on a local, multicore CPU with excess RAM we recommend calling</span></div><div class='output co'>#&gt; <span class='message'>  options(mc.cores = parallel::detectCores())</span></div><div class='input'>
<span class='co'># intentionally use small 'iter' so there are some</span>
<span class='co'># problems with rhat and neff for demonstration</span>
<span class='va'>fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://mc-stan.org/rstanarm/reference/stan_glm.html'>stan_glm</a></span><span class='op'>(</span><span class='va'>mpg</span> <span class='op'>~</span> <span class='va'>.</span>, data <span class='op'>=</span> <span class='va'>mtcars</span>, iter <span class='op'>=</span> <span class='fl'>50</span>, refresh <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: There were 5 divergent transitions after warmup. See</span>
#&gt; <span class='warning'>https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</span>
#&gt; <span class='warning'>to find out why this is a problem and how to eliminate them.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Examine the pairs() plot to diagnose sampling problems</span></div><div class='output co'>#&gt; <span class='warning'>Warning: The largest R-hat is 1.28, indicating chains have not mixed.</span>
#&gt; <span class='warning'>Running the chains for more iterations may help. See</span>
#&gt; <span class='warning'>https://mc-stan.org/misc/warnings.html#r-hat</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span>
#&gt; <span class='warning'>Running the chains for more iterations may help. See</span>
#&gt; <span class='warning'>https://mc-stan.org/misc/warnings.html#bulk-ess</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span>
#&gt; <span class='warning'>Running the chains for more iterations may help. See</span>
#&gt; <span class='warning'>https://mc-stan.org/misc/warnings.html#tail-ess</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Markov chains did not converge! Do not analyze results!</span></div><div class='input'><span class='va'>rhats</span> <span class='op'>&lt;-</span> <span class='fu'><a href='bayesplot-extractors.html'>rhat</a></span><span class='op'>(</span><span class='va'>fit</span><span class='op'>)</span>
<span class='va'>ratios</span> <span class='op'>&lt;-</span> <span class='fu'><a href='bayesplot-extractors.html'>neff_ratio</a></span><span class='op'>(</span><span class='va'>fit</span><span class='op'>)</span>
<span class='fu'>mcmc_rhat</span><span class='op'>(</span><span class='va'>rhats</span><span class='op'>)</span>
</div><div class='img'><img src='MCMC-diagnostics-11.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>mcmc_neff</span><span class='op'>(</span><span class='va'>ratios</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
</div><div class='img'><img src='MCMC-diagnostics-12.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># there's a small enough number of parameters in the</span>
<span class='co'># model that we can display their names on the y-axis</span>
<span class='fu'>mcmc_neff</span><span class='op'>(</span><span class='va'>ratios</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='bayesplot-helpers.html'>yaxis_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
</div><div class='img'><img src='MCMC-diagnostics-13.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># can also look at autocorrelation</span>
<span class='va'>draws</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/array.html'>as.array</a></span><span class='op'>(</span><span class='va'>fit</span><span class='op'>)</span>
<span class='fu'>mcmc_acf</span><span class='op'>(</span><span class='va'>draws</span>, pars <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"wt"</span>, <span class='st'>"cyl"</span><span class='op'>)</span>, lags <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>
</div><div class='img'><img src='MCMC-diagnostics-14.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># increase number of iterations and plots look much better</span>
<span class='va'>fit2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span><span class='op'>(</span><span class='va'>fit</span>, iter <span class='op'>=</span> <span class='fl'>500</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span>
#&gt; <span class='warning'>Running the chains for more iterations may help. See</span>
#&gt; <span class='warning'>https://mc-stan.org/misc/warnings.html#bulk-ess</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span>
#&gt; <span class='warning'>Running the chains for more iterations may help. See</span>
#&gt; <span class='warning'>https://mc-stan.org/misc/warnings.html#tail-ess</span></div><div class='input'><span class='fu'>mcmc_rhat</span><span class='op'>(</span><span class='fu'><a href='bayesplot-extractors.html'>rhat</a></span><span class='op'>(</span><span class='va'>fit2</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='MCMC-diagnostics-15.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>mcmc_neff</span><span class='op'>(</span><span class='fu'><a href='bayesplot-extractors.html'>neff_ratio</a></span><span class='op'>(</span><span class='va'>fit2</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='MCMC-diagnostics-16.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>mcmc_acf</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/array.html'>as.array</a></span><span class='op'>(</span><span class='va'>fit2</span><span class='op'>)</span>, pars <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"wt"</span>, <span class='st'>"cyl"</span><span class='op'>)</span>, lags <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>
</div><div class='img'><img src='MCMC-diagnostics-17.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># }</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jonah Gabry, Tristan Mahr.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '28ab84fbf0d3f58232875561b9a208cd',
    indexName: 'bayesplot',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


